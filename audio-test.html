
<!DOCTYPE html>
<html>
<head>
    <title>ScribeAI MediaRecorder Test</title>
</head>
<body>
    <h1>ScribeAI Audio Test</h1>
    <button id="testMic">Test Microphone</button>
    <button id="testTab">Test Tab Audio</button>
    <div id="results"></div>
    
    <script>
        const results = document.getElementById('results');
        
        document.getElementById('testMic').onclick = async () => {
            try {
                const stream = await navigator.mediaDevices.getUserMedia({ 
                    audio: {
                        echoCancellation: true,
                        noiseSuppression: true,
                        sampleRate: 44100
                    }
                });
                
                const recorder = new MediaRecorder(stream, {
                    mimeType: MediaRecorder.isTypeSupported('audio/webm') ? 'audio/webm' : 'audio/mp4'
                });
                
                results.innerHTML += '<p>‚úÖ Microphone access granted</p>';
                results.innerHTML += '<p>üìã MIME type: ' + recorder.mimeType + '</p>';
                
                stream.getTracks().forEach(track => track.stop());
            } catch (error) {
                results.innerHTML += '<p>‚ùå Microphone error: ' + error.message + '</p>';
            }
        };
        
        document.getElementById('testTab').onclick = async () => {
            try {
                const stream = await navigator.mediaDevices.getDisplayMedia({ 
                    audio: true, 
                    video: false 
                });
                
                results.innerHTML += '<p>‚úÖ Tab audio access granted</p>';
                stream.getTracks().forEach(track => track.stop());
            } catch (error) {
                results.innerHTML += '<p>‚ùå Tab audio error: ' + error.message + '</p>';
            }
        };
        
        // Test Socket.io connection
        const script = document.createElement('script');
        script.src = 'http://localhost:3001/socket.io/socket.io.js';
        script.onload = () => {
            const socket = io('http://localhost:3001');
            socket.on('connect', () => {
                results.innerHTML += '<p>‚úÖ Socket.io connection successful</p>';
            });
            socket.on('connect_error', () => {
                results.innerHTML += '<p>‚ùå Socket.io connection failed</p>';
            });
        };
        document.head.appendChild(script);
    </script>
</body>
</html>
